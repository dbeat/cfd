
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>CFD Modules &#8212; cfd  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Utils Modules" href="utils.html" />
    <link rel="prev" title="Packages" href="index.html" /> 
<link rel="stylesheet" type="text/css"
     href="../_static/style.css" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Packages</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">CFD Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utils Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#tests">Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#tests-coverage">Tests Coverage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">References</a></li>
</ul>


  <h3><a href="../index.html">Page Content</a></h3>
  <ul>
<li><a class="reference internal" href="#">CFD Modules</a><ul>
<li><a class="reference internal" href="#models-2d">models_2d</a><ul>
<li><a class="reference internal" href="#axi-symmetric">axi-symmetric</a><ul>
<li><a class="reference internal" href="#module-cfd.models_2d.axi_symmetric.poiseuille_axi">Poiseuille-Axi</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="cfd-modules">
<h1>CFD Modules<a class="headerlink" href="#cfd-modules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="models-2d">
<h2>models_2d<a class="headerlink" href="#models-2d" title="Permalink to this headline">¶</a></h2>
<div class="section" id="axi-symmetric">
<h3>axi-symmetric<a class="headerlink" href="#axi-symmetric" title="Permalink to this headline">¶</a></h3>
<div class="section" id="module-cfd.models_2d.axi_symmetric.poiseuille_axi">
<span id="poiseuille-axi"></span><h4>Poiseuille-Axi<a class="headerlink" href="#module-cfd.models_2d.axi_symmetric.poiseuille_axi" title="Permalink to this headline">¶</a></h4>
<p>models_2d.axi_symmetric.poiseuille_axi.py
November 14, 2019
&#64;author Francois Roy</p>
<dl class="class">
<dt id="cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi">
<em class="property">class </em><code class="sig-prename descclassname">cfd.models_2d.axi_symmetric.poiseuille_axi.</code><code class="sig-name descname">PoiseuilleAxi</code><span class="sig-paren">(</span><em class="sig-param">tag='pa', size=&lt;Quantity([ 20. 100.], 'millimeter')&gt;, mu=&lt;Quantity(0.0008548, 'pascal * second')&gt;, rho=&lt;Quantity(996.534, 'kilogram / meter ** 3')&gt;, pin=&lt;Quantity(8.0, 'pascal')&gt;, pout=&lt;Quantity(0.0, 'pascal')&gt;, ne_r=10, ne_z=100</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cfd/models_2d/axi_symmetric/poiseuille_axi.html#PoiseuilleAxi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">fem.model.Model</span></code></p>
<p>The unsteady laminar flow of a newtonian, incompressible fluid in
a circular pipe, termed Poiseuille flow, has an analytical solution.</p>
<p>we consider here a fluid of constant density <span class="math notranslate nohighlight">\(\rho\)</span> and viscosity
<span class="math notranslate nohighlight">\(\mu\)</span>, flowing in a vertical tube of length <span class="math notranslate nohighlight">\(L\)</span> and radius
<span class="math notranslate nohighlight">\(R\)</span>. The liquid flows downward under the influence of a pressure
difference and gravity. The tube length is specified to be large  with
respect to the tube radius, so that end effects will be unimportant
throughout most of the tube (flow parallel to the tube wall at the inlet
and outlet).</p>
<p>We assume a negligible radial component of the velocity, a no-slip
condition at the wall, i.e. <span class="math notranslate nohighlight">\(u_z=0\)</span> at
<span class="math notranslate nohighlight">\(r=R\)</span>, and axial symmetry, i.e.
<span class="math notranslate nohighlight">\(\frac{\partial u_z}{\partial r}=0\)</span>, at <span class="math notranslate nohighlight">\(r=0\)</span>.</p>
<p>The equations representing the fluid dynamics are obtained from the
conservation of mass (continuity) and momentum (Navier-Stokes).</p>
<p>For incompressible flow, the continuity equation is:</p>
<div class="math notranslate nohighlight">
\[\nabla\cdot \mathbf{u} = 0\]</div>
<p>and the Navier-Stokes equation becomes:</p>
<div class="math notranslate nohighlight">
\[\rho\left(\frac{\partial\mathbf{u}}{\partial t} +
\mathbf{u}\cdot\nabla \mathbf{u}\right) = -\nabla p +
\nabla\cdot\bar{\tau} + \mathbf{F}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> is the fluid velocity,  <span class="math notranslate nohighlight">\(p\)</span> is the pressure
and where <span class="math notranslate nohighlight">\(\mathbf{F}=\rho\mathbf{g}\)</span> is the volume force due to
gravity. The stress tensor <span class="math notranslate nohighlight">\(\bar{\tau}\)</span> is denoted by</p>
<div class="math notranslate nohighlight">
\[\bar{\tau} = 2\mu\bar{\epsilon}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\bar{\epsilon} = \frac{1}{2}\left(\nabla \mathbf{u} +
(\nabla\mathbf{u})^T \right)\]</div>
<p>is the strain-rate tensor.</p>
<p>Note that the Navier-Stokes equations are considered time-dependent.</p>
<p><strong>Cylindrical Coordinates</strong></p>
<p>The Navier-Stokes equation is written by
components in cylindrical coordinates (<span class="math notranslate nohighlight">\(r,~\theta,~z\)</span>):</p>
<p><span class="math notranslate nohighlight">\(r\)</span>-component:</p>
<div class="math notranslate nohighlight">
\[\rho\left(\frac{\partial}{\partial t}u_r+
u_r\frac{\partial}{\partial r}u_r+\frac{u_\theta}{r}\frac{\partial}
{\partial \theta}u_r+u_z\frac{\partial}{\partial z}u_r
-\frac{u_\theta^2}{r}\right) = -\frac{\partial}{\partial r}p +
\mu\left(\frac{\partial}{\partial r}\left(\frac{1}{r}
\frac{\partial}{\partial r}(ru_r)\right) +
\frac{1}{r^2}\frac{\partial^2}{\partial \theta^2}u_r+
\frac{\partial^2}{\partial z^2}u_r-
\frac{2}{r^2}\frac{\partial}{\partial \theta}u_\theta\right) +\rho g_r\]</div>
<p><span class="math notranslate nohighlight">\(\theta\)</span>-component:</p>
<div class="math notranslate nohighlight">
\[\rho\left(\frac{\partial}{\partial t}u_\theta+
u_r\frac{\partial}{\partial r}u_\theta+\frac{u_\theta}{r}\frac{\partial}
{\partial \theta}u_\theta+u_z\frac{\partial}{\partial z}u_\theta
+\frac{u_ru_\theta}{r}\right) = -\frac{1}{r}\frac{\partial}
{\partial \theta}p +
\mu\left(\frac{\partial}{\partial r}\left(\frac{1}{r}
\frac{\partial}{\partial r}(ru_\theta)\right) +
\frac{1}{r^2}\frac{\partial^2}{\partial \theta^2}u_\theta+
\frac{\partial^2}{\partial z^2}u_\theta+
\frac{2}{r^2}\frac{\partial}{\partial \theta}u_r\right) +\rho g_\theta\]</div>
<p><span class="math notranslate nohighlight">\(z\)</span>-component:</p>
<div class="math notranslate nohighlight">
\[\rho\left(\frac{\partial}{\partial t}u_z+
u_r\frac{\partial}{\partial r}u_z+\frac{u_\theta}{r}\frac{\partial}
{\partial \theta}u_z+u_z\frac{\partial}{\partial z}u_z\right)
 = -\frac{\partial}
{\partial z}p +
\mu\left(\frac{1}{r}\frac{\partial}{\partial r}\left(r
\frac{\partial}{\partial r}u_z\right) +
\frac{1}{r^2}\frac{\partial^2}{\partial \theta^2}u_z+
\frac{\partial^2}{\partial z^2}u_z\right) +\rho g_z\]</div>
<p>The continuity equation in cylindrical component is:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{r}\left(\frac{\partial}{\partial r}(ru_r)
+\frac{\partial}{\partial \theta}(u_\theta)\right) +
\frac{\partial}{\partial z} u_z = 0\]</div>
<p><strong>Axisymmetric Formulation</strong></p>
<p>In an axisymmetric model there is no gradient in the azimuthal
direction <span class="math notranslate nohighlight">\(\theta\)</span>. If we also assume that the
<span class="math notranslate nohighlight">\(\theta\)</span>-component of the velocity field is zero, the
<span class="math notranslate nohighlight">\(\theta\)</span>-component of the Navier-Stokes equation is removed and
the continuity/momentum equations become:</p>
<p>Continuity:</p>
<div class="math notranslate nohighlight">
\[\frac{u_r}{r}+\frac{\partial}{\partial r}u_r
+ \frac{\partial}{\partial z} u_z = 0\]</div>
<p>Navier-Stokes, <span class="math notranslate nohighlight">\(r\)</span>-component:</p>
<div class="math notranslate nohighlight">
\[\rho\left(\frac{\partial}{\partial t}u_r+
u_r\frac{\partial}{\partial r}u_r
+u_z\frac{\partial}{\partial z}u_r\right)
 = -\frac{\partial}{\partial r}p +
\mu\left(\frac{\partial}{\partial r}\left(\frac{u_r}{r}+
\frac{\partial}{\partial r}u_r\right) +
\frac{\partial^2}{\partial z^2}u_r\right)\]</div>
<p>Navier-Stokes, <span class="math notranslate nohighlight">\(z\)</span>-component:</p>
<div class="math notranslate nohighlight">
\[\rho\left(\frac{\partial}{\partial t}u_z+
u_r\frac{\partial}{\partial r}u_z
+u_z\frac{\partial}{\partial z}u_z\right)
 = -\frac{\partial}
{\partial z}p +
\mu\left(\frac{1}{r}\frac{\partial}{\partial r}\left(r
\frac{\partial}{\partial r}u_z\right) +
\frac{\partial^2}{\partial z^2}u_z\right) +\rho g_z\]</div>
<p>Note that the gravity term only have a <span class="math notranslate nohighlight">\(z\)</span>-component.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tag</strong> – The model name – default pa</p></li>
<li><p><strong>size</strong> – The radius and length of the pipe [radius, height],
–default 20 mm and 100 mm.</p></li>
<li><p><strong>mu</strong> – Dynamic viscosity – default 8.548e-4 Pa.s (water 300 K).</p></li>
<li><p><strong>rho</strong> – Density – default 996.534 kg/m3 (water 300 K).</p></li>
<li><p><strong>pin</strong> – Inlet pressure – default 8 Pa.</p></li>
<li><p><strong>pout</strong> – Outlet pressure – default 0 Pa.</p></li>
<li><p><strong>ne_r</strong> – Number of element along the radius of the pipe – default 10.</p></li>
<li><p><strong>ne_z</strong> – Number of element along the height of the pipe – default 100.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.axial_line">
<code class="sig-name descname">axial_line</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cfd/models_2d/axi_symmetric/poiseuille_axi.html#PoiseuilleAxi.axial_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.axial_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Define an axial line on which the solution <span class="math notranslate nohighlight">\(p\)</span> can be
mapped (interpolated).</p>
</dd></dl>

<dl class="method">
<dt id="cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.compute">
<code class="sig-name descname">compute</code><span class="sig-paren">(</span><em class="sig-param">t_end=&lt;Quantity(10.0</em>, <em class="sig-param">'second')&gt;</em>, <em class="sig-param">num_steps=500</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cfd/models_2d/axi_symmetric/poiseuille_axi.html#PoiseuilleAxi.compute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>For incompressible flow, the continuity equation is:</p>
<div class="math notranslate nohighlight">
\[\nabla\cdot \mathbf{u} = 0\]</div>
<p>and the Navier-Stokes equation becomes:</p>
<div class="math notranslate nohighlight">
\[\rho\left(\frac{\partial\mathbf{u}}{\partial t} +
\mathbf{u}\cdot\nabla \mathbf{u}\right) =
\nabla\cdot\bar{\pi} + \mathbf{F}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> is the fluid velocity,  <span class="math notranslate nohighlight">\(p\)</span> is the
pressure and where <span class="math notranslate nohighlight">\(\mathbf{F}=\rho\mathbf{g}\)</span> is the volume
force due to gravity. The molecular stress tensor <span class="math notranslate nohighlight">\(\bar{\pi}\)</span> is
denoted by:</p>
<div class="math notranslate nohighlight">
\[\bar{\pi} = \bar{\tau} - p\bar{I}, \quad \bar{I}\textrm{ is
the unit tensor}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{\tau}\)</span> is the viscous stress tensor defined by:</p>
<div class="math notranslate nohighlight">
\[\bar{\tau} = 2\mu\bar{\epsilon}\]</div>
<p>and where</p>
<div class="math notranslate nohighlight">
\[\bar{\epsilon} = \frac{1}{2}\left(\nabla \mathbf{u} +
(\nabla\mathbf{u})^T \right)\]</div>
<p>is the strain-rate tensor.</p>
<p>The variational formulation of the viscous term is:</p>
<div class="math notranslate nohighlight">
\[\int_\Omega \left(\nabla\cdot\bar{\pi}\right)\cdot
\mathbf{v}d\mathbf{x}\]</div>
<p>Since the term <span class="math notranslate nohighlight">\(\nabla\cdot\bar{\pi}\)</span> contains second-order
derivatives of the velocity field <span class="math notranslate nohighlight">\(\mathbf{u}\)</span>, we integrate this
term by parts:</p>
<div class="math notranslate nohighlight">
\[-\int_\Omega\left(\nabla\cdot\bar{\pi}\right)\cdot
\mathbf{v}d\mathbf{x} = \int_\Omega \bar{\pi}:\nabla
\mathbf{v}d\mathbf{x}-\int_{\delta\Omega}\left(\bar{\pi}
\cdot\hat{\mathbf{n}}\right)\cdot\mathbf{v}ds\]</div>
<p>where the colon operator is the inner product (Frobenius inner-product)
between tensors, and <span class="math notranslate nohighlight">\(\hat{\mathbf{n}}\)</span> is the outward unit
normal at the boundary (traction, or stress vector).</p>
<p>In cylindrical coordinates (<span class="math notranslate nohighlight">\(r,~ \theta,~ z\)</span>), the gradient of
the velocity field <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> writes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla\cdot{\mathbf{u}} = \left(
\begin{array}{ccc}
  \frac{\partial u_r}{\partial r} &amp;
  \frac{\partial u_\theta}{\partial r} &amp;
  \frac{\partial u_z}{\partial r}\\
  \frac{1}{r}\frac{\partial u_r}{\partial \theta}-
  \frac{u_\theta}{r}&amp;
  \frac{1}{r}\frac{\partial u_\theta}{\partial \theta}+
   \frac{u_r}{r}&amp;
  \frac{1}{r}\frac{\partial u_z}{\partial \theta}\\
  \frac{\partial u_r}{\partial z} &amp;
  \frac{\partial u_\theta}{\partial z} &amp;
  \frac{\partial u_z}{\partial z}
\end{array}
\right)\end{split}\]</div>
<p>The strain-rate tensor <span class="math notranslate nohighlight">\(\bar{\epsilon}\)</span> is then:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\bar{\epsilon} = \left(
\begin{array}{ccc}
  \frac{\partial u_r}{\partial r} &amp;
  \frac{1}{2}\left(\frac{\partial u_\theta}{\partial r} +
  \frac{1}{r}\frac{\partial u_\theta}{\partial \theta}-
   \frac{u_\theta}{r}\right)&amp;
  \frac{1}{2}\left(\frac{\partial u_z}{\partial r}+
  \frac{\partial u_r}{\partial z}\right)\\
  \frac{1}{2}\left(\frac{1}{r}\frac{\partial u_r}{\partial \theta}-
  \frac{u_\theta}{r}+\frac{\partial u_\theta}{\partial r}\right)&amp;
  \frac{1}{r}\frac{\partial u_\theta}{\partial \theta}+
   \frac{u_r}{r}&amp;
  \frac{1}{2}\left(\frac{1}{r}\frac{\partial u_z}{\partial
  \theta}+\frac{\partial u_\theta}{\partial z}\right)\\
  \frac{1}{2}\left(\frac{\partial u_r}{\partial z}
  +\frac{\partial u_z}{\partial r}\right)&amp;
  \frac{1}{2}\left(\frac{\partial u_\theta}{\partial z}
  +\frac{1}{r}\frac{\partial u_z}{\partial \theta}\right)&amp;
  \frac{\partial u_z}{\partial z}
\end{array}
\right)\end{split}\]</div>
<p>From the definition above, the viscous stress tensor <span class="math notranslate nohighlight">\(\bar{\tau}\)</span>
is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\bar{\tau} = \mu\left(
\begin{array}{ccc}
  2\frac{\partial u_r}{\partial r} &amp;
  \frac{\partial u_\theta}{\partial r} +
  \frac{1}{r}\frac{\partial u_\theta}{\partial \theta}-
   \frac{u_\theta}{r}&amp;
  \frac{\partial u_z}{\partial r}+
  \frac{\partial u_r}{\partial z}\\
  \frac{1}{r}\frac{\partial u_r}{\partial \theta}-
  \frac{u_\theta}{r}+\frac{\partial u_\theta}{\partial r}&amp;
  2\left(\frac{1}{r}\frac{\partial u_\theta}{\partial \theta}+
   \frac{u_r}{r}\right)&amp;
  \frac{1}{r}\frac{\partial u_z}{\partial
  \theta}+\frac{\partial u_\theta}{\partial z}\\
  \frac{\partial u_r}{\partial z}
  +\frac{\partial u_z}{\partial r}&amp;
  \frac{\partial u_\theta}{\partial z}
  +\frac{1}{r}\frac{\partial u_z}{\partial \theta}&amp;
  2\frac{\partial u_z}{\partial z}
\end{array}
\right)\end{split}\]</div>
<p>and the molecular stress tensor <span class="math notranslate nohighlight">\(\bar{\pi}\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\bar{\pi} = \mu\left(
\begin{array}{ccc}
  2\frac{\partial u_r}{\partial r} -\frac{p}{\mu}&amp;
  \frac{\partial u_\theta}{\partial r} +
  \frac{1}{r}\frac{\partial u_\theta}{\partial \theta}-
   \frac{u_\theta}{r}&amp;
  \frac{\partial u_z}{\partial r}+
  \frac{\partial u_r}{\partial z}\\
  \frac{1}{r}\frac{\partial u_r}{\partial \theta}-
  \frac{u_\theta}{r}+\frac{\partial u_\theta}{\partial r}&amp;
  2\left(\frac{1}{r}\frac{\partial u_\theta}{\partial \theta}+
   \frac{u_r}{r}\right) -\frac{p}{\mu} &amp;
  \frac{1}{r}\frac{\partial u_z}{\partial
  \theta}+\frac{\partial u_\theta}{\partial z}\\
  \frac{\partial u_r}{\partial z}
  +\frac{\partial u_z}{\partial r}&amp;
  \frac{\partial u_\theta}{\partial z}
  +\frac{1}{r}\frac{\partial u_z}{\partial \theta}&amp;
  2\frac{\partial u_z}{\partial z} -\frac{p}{\mu}
\end{array}
\right)\end{split}\]</div>
<p>The scalar product (or double dot product) of two tensors is the
summed pairwise product of all element of the tensors, i.e.</p>
<div class="math notranslate nohighlight">
\[\bar{\pi}:\nabla\mathbf{v} =
\pi_{rr}\frac{\partial v_r}{\partial r}+
\pi_{r\theta}\frac{\partial v_\theta}{\partial r}+\ldots +
\pi_{zz}\frac{\partial v_z}{\partial z}\]</div>
<p>and the vector product (or dot product) of a tensor with a vector is
just the regular product between a matrix and a vector.</p>
<div class="math notranslate nohighlight">
\[\bar{\pi}\cdot \hat{\mathbf{n}} = \left(\pi_{rr}n_r+
\pi_{r\theta}n_\theta + \pi_{rz}nz\right) \hat{\mathbf{e}}_r +
\left(\pi_{\theta r}n_r + \dots\right)\hat{\mathbf{e}}_\theta +
\left(\ldots + \pi_{r\theta}n_\theta\right)\hat{\mathbf{e}}_z\]</div>
<p><strong>Axisymmetric Formulation</strong></p>
<p>We consider a solid of revolution around a fixed axis (Oz), the
loading, boundary conditions and material properties are invariant
with respect to a rotation along the symmetry axis. The solid
cross-section in a plane <span class="math notranslate nohighlight">\(\Theta=\)</span> cst is represented by
a two-dimensional domain <span class="math notranslate nohighlight">\(\omega\)</span> for which the first spatial
variable (x[0] in FEniCS) will represent the radial coordinate
<span class="math notranslate nohighlight">\(r\)</span> whereas the second spatial variable will denote the axial
variable <span class="math notranslate nohighlight">\(z\)</span>.</p>
<p>In axisymmetric conditions, the full 3D domain <span class="math notranslate nohighlight">\(\Omega\)</span> can be
decomposed as <span class="math notranslate nohighlight">\(\Omega=\omega\times[0;2\pi]\)</span> where the interval
represents the <span class="math notranslate nohighlight">\(\theta\)</span> variable. The integration measures
therefore reduce to <span class="math notranslate nohighlight">\(dx=d\omega\cdot(rd\theta)\)</span> and
<span class="math notranslate nohighlight">\(dS=ds\cdot(rd\theta)\)</span> where <span class="math notranslate nohighlight">\(dS\)</span> is the surface
integration measure on the 3D domain <span class="math notranslate nohighlight">\(\Omega\)</span> and <span class="math notranslate nohighlight">\(ds\)</span> its
counterpart on the cross-section boundary <span class="math notranslate nohighlight">\(\partial\omega\)</span>.</p>
<p>Exploiting the invariance of all fields with respect to <span class="math notranslate nohighlight">\(\theta\)</span>,
we get the variational formulation of the viscous term as:</p>
<blockquote>
<div><div class="math notranslate nohighlight">
\[-\int_\Omega\left(\nabla\cdot\bar{\pi}\right)\cdot
\mathbf{v}d\mathbf{x} = 2\pi\int_\omega \bar{\pi}:\nabla
\mathbf{v}rd\omega-2\pi\int_{\delta\omega}\left(\bar{\pi}
\cdot\hat{\mathbf{n}}\right)\cdot\mathbf{v}r ds\]</div>
</div></blockquote>
<p>For an axisymmetric model there is no gradient in the azimuthal
direction <span class="math notranslate nohighlight">\(\theta\)</span>. If we also assume that the
<span class="math notranslate nohighlight">\(\theta\)</span>-component of the velocity field is zero, we obtain
the gradient of the velocity field:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla\cdot{\mathbf{u}} = \left(
\begin{array}{ccc}
  \frac{\partial u_r}{\partial r} &amp;
  0 &amp;
  \frac{\partial u_z}{\partial r}\\
  0&amp;
   \frac{u_r}{r}&amp;
  0\\
  \frac{\partial u_r}{\partial z} &amp;
  0&amp;
  \frac{\partial u_z}{\partial z}
\end{array}
\right)\end{split}\]</div>
<p>and the following strain-rate tensor:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\bar{\epsilon} = \left(
\begin{array}{ccc}
  \frac{\partial u_r}{\partial r} &amp;
  0&amp;
  \frac{1}{2}\left(\frac{\partial u_z}{\partial r}+
  \frac{\partial u_r}{\partial z}\right)\\
  0&amp;
   \frac{u_r}{r}&amp;
  0\\
  \frac{1}{2}\left(\frac{\partial u_r}{\partial z}
  +\frac{\partial u_z}{\partial r}\right)&amp;
  0&amp;
  \frac{\partial u_z}{\partial z}
\end{array}
\right)\end{split}\]</div>
<p><em>Note</em>: The vector function space dimension is now two-dimensional.
We can keep the 3D tensor notation if we perform the integrands
manually before assembling the bilinear and linear forms.</p>
<p><em>Note</em>: The factor <span class="math notranslate nohighlight">\(u_r/r\)</span> is problematic for
<span class="math notranslate nohighlight">\(r\approx 0\)</span>. One solution is to …</p>
<p>for axisymmetric flow, the velocity field is composed of two
components, i.e.</p>
<div class="math notranslate nohighlight">
\[\mathbf{u} = u_r\hat{\mathbf{e}}_r+u_z\hat{\mathbf{e}}_z\]</div>
<p><strong>Splitting Method</strong>:</p>
<p>To overcome the saddle-point problems resulting from a direct
discretization of the Navier-Stokes equations we use a splitting scheme
where the velocity and pressure variables are computed in a sequence of
predictor-corrector type steps.</p>
<p>Incremental Pressure Correction Scheme (IPCS) – see <span class="bibtex" id="id1">[Logg2012]</span>
for details of the algorithm.</p>
<p>In summary, we may thus solve the incompressible Navier-Stokes
equations efficiently by solving a sequence of three linear
variational problems in each time step.</p>
<p>In order to simulate steady-state use t_end = large number</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_end</strong> (<em>ureg.Quantity</em>) – Final time, default = 10 s.</p></li>
<li><p><strong>num_steps</strong> (<em>int</em>) – Number of time steps, default = 500.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The solution.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.exact_solution">
<code class="sig-name descname">exact_solution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cfd/models_2d/axi_symmetric/poiseuille_axi.html#PoiseuilleAxi.exact_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.exact_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>This method is used to validate the finite element model.</p>
<p>Here we assume that the flow is directed along the
<span class="math notranslate nohighlight">\(z\)</span>-direction (parallel to the tube walls), which leads to
<span class="math notranslate nohighlight">\(u_r=0\)</span>. The only external force acting on the fluid is gravity
(<span class="math notranslate nohighlight">\(\mathbf{F}\textrm{ext}=-\rho g_z\mathbf{\hat{e}}_z\)</span>).</p>
<p>Using the axisymmetric formulation we have:</p>
<p>continuity:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial z} u_z = 0\]</div>
<p>Navier-Stokes, <span class="math notranslate nohighlight">\(r\)</span>-component:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial r}p = 0\]</div>
<p>Navier-Stokes, <span class="math notranslate nohighlight">\(z\)</span>-component:</p>
<div class="math notranslate nohighlight">
\[\rho\frac{\partial}{\partial t}u_z
 = -\frac{\partial}
{\partial z}p +
\mu\left(\frac{1}{r}\frac{\partial}{\partial r}\left(r
\frac{\partial}{\partial r}u_z\right)\right) - \rho g_z\]</div>
<p>When steady-state is reached, the term
<span class="math notranslate nohighlight">\(\frac{\partial}{\partial t}u_z=0\)</span>. Using the product rule
we have:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial z}p =
\mu\left(\frac{1}{r}\frac{\partial}{\partial r}u_z +
\frac{\partial^2}{\partial r^2}u_z
\right)-\rho g_z\]</div>
<p>with the following change of variable:</p>
<div class="math notranslate nohighlight">
\[\phi = r\frac{\partial u_z}{\partial r}\]</div>
<p>we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\partial \phi}{\partial r} &amp;=
\frac{\partial u_z}{\partial r} +
r\frac{\partial^2u_z}{\partial r^2}\\
&amp;= \frac{\phi}{r} + r\frac{\partial^2u_z}{\partial r^2}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial z}p =
\mu\left(\frac{1}{r}\frac{\partial \phi}{\partial r}\right)-
\rho g_z\]</div>
<p>From <span class="math notranslate nohighlight">\(\frac{\partial u_z}{\partial z} = 0\)</span>
(<span class="math notranslate nohighlight">\(\frac{\partial \phi}{\partial z} = 0\)</span>) and
<span class="math notranslate nohighlight">\(\frac{\partial p}{\partial r} = 0\)</span> we can solve the above
equation by separation of variable, i.e.</p>
<div class="math notranslate nohighlight">
\[\int dp =\int \left(\mu\left(\frac{1}{r}
\frac{\partial \phi}{\partial r}\right)-\rho g_z\right)dz\]</div>
<div class="math notranslate nohighlight">
\[\Delta p =
\left(\mu\left(\frac{1}{r}\frac{\partial \phi}{\partial r}
\right)-\rho g_z\right)\Delta z\]</div>
<div class="math notranslate nohighlight">
\[\frac{\Delta p+
\rho g_z\Delta z}{\mu \Delta z} =
\frac{1}{r}\frac{\partial \phi}{\partial r}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\Delta p = p(z=L+z_0) - p(z=z_0)\)</span>, and where
<span class="math notranslate nohighlight">\(\Delta z = z_0+L - z_0 = L\)</span>.</p>
<p>By another separation of variable</p>
<div class="math notranslate nohighlight">
\[\int \frac{\Delta p+
\rho g_z\Delta z}{\mu \Delta z} r dr =
\int d\phi\]</div>
<p>which gives</p>
<div class="math notranslate nohighlight">
\[\phi = \frac{1}{2}\frac{\Delta p+
\rho g_z\Delta z}{\mu \Delta z}r^2 + C_1\]</div>
<p>at <span class="math notranslate nohighlight">\(r=0\)</span> we have <span class="math notranslate nohighlight">\(\phi(0)=0\)</span> and <span class="math notranslate nohighlight">\(C_1=0\)</span>.
Substituting the value of <span class="math notranslate nohighlight">\(\phi\)</span> in the above equation yields to:</p>
<div class="math notranslate nohighlight">
\[r\frac{\partial u_z}{\partial r} = \frac{1}{2}
\frac{\Delta p+\rho g_z\Delta z}{\mu \Delta z}r^2\]</div>
<p>Integrating again on both sides gives:</p>
<div class="math notranslate nohighlight">
\[u_z = \frac{1}{4}
\frac{\Delta p+\rho g_z\Delta z}{\mu \Delta z}r^2 + C_2\]</div>
<p>with <span class="math notranslate nohighlight">\(u_z=0\)</span> at <span class="math notranslate nohighlight">\(r=R\)</span>, we get</p>
<div class="math notranslate nohighlight">
\[C_2 = -\frac{1}{4}
\frac{\Delta p+\rho g_z\Delta z}{\mu \Delta z}r^2\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[u_z = \frac{1}{4}
\frac{\Delta p+\rho g_z\Delta z}{\mu \Delta z}\left(r^2-R^2\right)\]</div>
<p>Rearranging the terms we get</p>
<div class="math notranslate nohighlight">
\[\begin{split}u_z &amp;= \frac{1}{4}
\frac{p(z=L)-p(z=z_0)+(\rho g_z(L-z_0)-\rho g_zz_0)}{\mu L}
\left(r^2-R^2\right)\\
&amp;= \frac{1}{4}
\frac{(p(z=L)+\rho g_z(L-z_0))-(p(z=z_0)+\rho g_z z_0)}
{\mu L}R^2\left(\left(\frac{r}{R}\right)^2-1\right)\\
&amp;=\frac{1}{4}
\frac{\mathcal{P}_L-\mathcal{P}_0}
{\mu L}R^2\left(\left(\frac{r}{R}\right)^2-1\right)\\
&amp;=\frac{1}{4}
\frac{\mathcal{P}_0-\mathcal{P}_L}
{\mu L}R^2\left(1-\left(\frac{r}{R}\right)^2\right)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathcal{P}_L=p(z=L)+\rho g_z(L-z_0)\)</span> and
<span class="math notranslate nohighlight">\(\mathcal{P}_0=p(z=z_0)+\rho g_zz_0\)</span></p>
<p>The pressure can be obtained using the Navier-Stokes,
<span class="math notranslate nohighlight">\(z\)</span>-component equation and the axial velocity <span class="math notranslate nohighlight">\(u_z\)</span>,
giving:</p>
<div class="math notranslate nohighlight">
\[p = p(z=z_0) - \left(p(z=z_0)-p(z=L)\right)\frac{z}{L}\]</div>
<p>For more info see <span class="bibtex" id="id2">[BSL2007]</span> p. 88.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The solution, i.e. <span class="math notranslate nohighlight">\((p, u_z)\)</span> respectively along the
center of the pipe line (symmetry axis), and along the radial
distance.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.geom">
<code class="sig-name descname">geom</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cfd/models_2d/axi_symmetric/poiseuille_axi.html#PoiseuilleAxi.geom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.geom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.mesh">
<code class="sig-name descname">mesh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cfd/models_2d/axi_symmetric/poiseuille_axi.html#PoiseuilleAxi.mesh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.mesh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.molecular_stress_tensor">
<code class="sig-name descname">molecular_stress_tensor</code><span class="sig-paren">(</span><em class="sig-param">u</em>, <em class="sig-param">p</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cfd/models_2d/axi_symmetric/poiseuille_axi.html#PoiseuilleAxi.molecular_stress_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.molecular_stress_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the molecular stress tensor:</p>
<div class="math notranslate nohighlight">
\[\bar{\pi} = 2\mu\bar{\epsilon}-p\bar{I}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> – The velocity field.</p></li>
<li><p><strong>p</strong> – The pressure field.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecular stress tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.radial_line">
<code class="sig-name descname">radial_line</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cfd/models_2d/axi_symmetric/poiseuille_axi.html#PoiseuilleAxi.radial_line"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.radial_line" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a radial line on which the solution <span class="math notranslate nohighlight">\(u_z\)</span> can be
mapped (interpolated).</p>
</dd></dl>

<dl class="method">
<dt id="cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.size">
<em class="property">property </em><code class="sig-name descname">size</code><a class="headerlink" href="#cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.size" title="Permalink to this definition">¶</a></dt>
<dd><p>The dimensions of the pipe [radius, height]</p>
</dd></dl>

<dl class="method">
<dt id="cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.strain_rate_tensor">
<code class="sig-name descname">strain_rate_tensor</code><span class="sig-paren">(</span><em class="sig-param">u</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/cfd/models_2d/axi_symmetric/poiseuille_axi.html#PoiseuilleAxi.strain_rate_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#cfd.models_2d.axi_symmetric.poiseuille_axi.PoiseuilleAxi.strain_rate_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the symmetric strain-rate tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>u</strong> – The velocity field (2D).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The strain rate tensor.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020, Francois Roy.
      
    </div>

    

    
  </body>
</html>